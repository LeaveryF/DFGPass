# DFGPass

## Intro

- An LLVM pass which generates .dot file of DFG(data flow graph)

## Usage

- Load `CMakeLists.txt`
- build, generate `build/DFGPass/libLLVMDFGPass.so`
- `opt -load build/DFGPass/libLLVMDFGPass.so input.bc -o output.bc`
  - Attention for LLVM version!!!
  - `-enable-new-pm=false` may be necessary
- generate `*.dot` files for each function in current directory

## Test

- move `a.o.3.bc` or your `.bc` file to `./test/`
- just run `./run.sh`

If have trouble, check `./run.sh`.

- `a.o.3.bc` is a file generated by Vitis
- `llvm-dis a.o.3.bc -o a.o.3.ll` to see its `.ll` code
- due to its fpga64-xilinx-none backend, which could not be identified by `opt`, just delete it
- `llvm-as a.o.3.ll -o a.o.3-as.bc` to transform to `a.o.3-as.bc` or not
- `opt a.o.3.ll ...` or `opt a.o.3-as.bc ...`
  - `llvm-dis` version and `opt` version must be the same
  - if some grammar is not supported by `opt`, consider lower `opt` version

- `./test/convert.py` would convert dot files to png, directory is specified in py code
